{"version":3,"names":["_livekitClient","require","_react","useParticipant","participant","isAudioMuted","setAudioMuted","useState","setVideoMuted","connectionQuality","setConnectionQuality","isSpeaking","setSpeaking","metadata","setMetadata","publications","setPublications","subscribedTracks","setSubscribedTracks","cameraPublication","setCameraPublication","getTrackPublication","Track","Source","Camera","microphonePublication","setMicrophonePublication","Microphone","screenSharePublication","setScreenSharePublication","ScreenShare","useEffect","onPublicationsChanged","Array","from","trackPublications","values","filter","pub","isSubscribed","track","undefined","onMuted","kind","Kind","Audio","Video","onUnmuted","onMetadataChanged","onIsSpeakingChanged","onConnectionQualityUpdate","on","ParticipantEvent","TrackMuted","TrackUnmuted","ParticipantMetadataChanged","IsSpeakingChanged","TrackPublished","TrackUnpublished","TrackSubscribed","TrackUnsubscribed","LocalTrackPublished","LocalTrackUnpublished","ConnectionQualityChanged","off","muted","audioTrackPublications","forEach","isMuted","isLocal","LocalParticipant"],"sources":["useParticipant.ts"],"sourcesContent":["import {\n  ConnectionQuality,\n  LocalParticipant,\n  Participant,\n  ParticipantEvent,\n  Track,\n  TrackPublication,\n} from 'livekit-client';\nimport { useEffect, useState } from 'react';\n\n/** @deprecated use `useRemoteParticipant` or `useLocalParticipant` instead */\nexport interface ParticipantState {\n  isSpeaking: boolean;\n  connectionQuality: ConnectionQuality;\n  isLocal: boolean;\n  metadata?: string;\n  publications: TrackPublication[];\n  subscribedTracks: TrackPublication[];\n  cameraPublication?: TrackPublication;\n  microphonePublication?: TrackPublication;\n  screenSharePublication?: TrackPublication;\n}\n/** @deprecated use `useRemoteParticipant` or `useLocalParticipant` instead */\nexport function useParticipant(participant: Participant): ParticipantState {\n  const [isAudioMuted, setAudioMuted] = useState(false);\n  const [, setVideoMuted] = useState(false);\n  const [connectionQuality, setConnectionQuality] = useState<ConnectionQuality>(\n    participant.connectionQuality\n  );\n  const [isSpeaking, setSpeaking] = useState(false);\n  const [metadata, setMetadata] = useState<string>();\n  const [publications, setPublications] = useState<TrackPublication[]>([]);\n  const [subscribedTracks, setSubscribedTracks] = useState<TrackPublication[]>(\n    []\n  );\n\n  const [cameraPublication, setCameraPublication] = useState(\n    participant.getTrackPublication(Track.Source.Camera)\n  );\n  const [microphonePublication, setMicrophonePublication] = useState(\n    participant.getTrackPublication(Track.Source.Microphone)\n  );\n  const [screenSharePublication, setScreenSharePublication] = useState(\n    participant.getTrackPublication(Track.Source.ScreenShare)\n  );\n  useEffect(() => {\n    const onPublicationsChanged = () => {\n      setPublications(Array.from(participant.trackPublications.values()));\n      setCameraPublication(\n        participant.getTrackPublication(Track.Source.Camera)\n      );\n      setMicrophonePublication(\n        participant.getTrackPublication(Track.Source.Microphone)\n      );\n      setScreenSharePublication(\n        participant.getTrackPublication(Track.Source.ScreenShare)\n      );\n      setSubscribedTracks(\n        Array.from(participant.trackPublications.values()).filter((pub) => {\n          return pub.isSubscribed && pub.track !== undefined;\n        })\n      );\n    };\n    const onMuted = (pub: TrackPublication) => {\n      if (pub.kind === Track.Kind.Audio) {\n        setAudioMuted(true);\n      } else if (pub.kind === Track.Kind.Video) {\n        setVideoMuted(true);\n      }\n    };\n    const onUnmuted = (pub: TrackPublication) => {\n      if (pub.kind === Track.Kind.Audio) {\n        setAudioMuted(false);\n      } else if (pub.kind === Track.Kind.Video) {\n        setVideoMuted(false);\n      }\n    };\n    const onMetadataChanged = () => {\n      if (participant.metadata) {\n        setMetadata(participant.metadata);\n      }\n    };\n    const onIsSpeakingChanged = () => {\n      setSpeaking(participant.isSpeaking);\n    };\n    const onConnectionQualityUpdate = () => {\n      setConnectionQuality(participant.connectionQuality);\n    };\n\n    // register listeners\n    participant\n      .on(ParticipantEvent.TrackMuted, onMuted)\n      .on(ParticipantEvent.TrackUnmuted, onUnmuted)\n      .on(ParticipantEvent.ParticipantMetadataChanged, onMetadataChanged)\n      .on(ParticipantEvent.IsSpeakingChanged, onIsSpeakingChanged)\n      .on(ParticipantEvent.TrackPublished, onPublicationsChanged)\n      .on(ParticipantEvent.TrackUnpublished, onPublicationsChanged)\n      .on(ParticipantEvent.TrackSubscribed, onPublicationsChanged)\n      .on(ParticipantEvent.TrackUnsubscribed, onPublicationsChanged)\n      .on(ParticipantEvent.LocalTrackPublished, onPublicationsChanged)\n      .on(ParticipantEvent.LocalTrackUnpublished, onPublicationsChanged)\n      .on(ParticipantEvent.ConnectionQualityChanged, onConnectionQualityUpdate);\n\n    // set initial state\n    onMetadataChanged();\n    onIsSpeakingChanged();\n    onPublicationsChanged();\n\n    return () => {\n      // cleanup\n      participant\n        .off(ParticipantEvent.TrackMuted, onMuted)\n        .off(ParticipantEvent.TrackUnmuted, onUnmuted)\n        .off(ParticipantEvent.ParticipantMetadataChanged, onMetadataChanged)\n        .off(ParticipantEvent.IsSpeakingChanged, onIsSpeakingChanged)\n        .off(ParticipantEvent.TrackPublished, onPublicationsChanged)\n        .off(ParticipantEvent.TrackUnpublished, onPublicationsChanged)\n        .off(ParticipantEvent.TrackSubscribed, onPublicationsChanged)\n        .off(ParticipantEvent.TrackUnsubscribed, onPublicationsChanged)\n        .off(ParticipantEvent.LocalTrackPublished, onPublicationsChanged)\n        .off(ParticipantEvent.LocalTrackUnpublished, onPublicationsChanged)\n        .off(\n          ParticipantEvent.ConnectionQualityChanged,\n          onConnectionQualityUpdate\n        );\n    };\n  }, [participant]);\n\n  let muted: boolean | undefined;\n  participant.audioTrackPublications.forEach((pub) => {\n    muted = pub.isMuted;\n  });\n  if (muted === undefined) {\n    muted = true;\n  }\n  if (isAudioMuted !== muted) {\n    setAudioMuted(muted);\n  }\n\n  return {\n    isLocal: participant instanceof LocalParticipant,\n    isSpeaking,\n    connectionQuality,\n    publications,\n    subscribedTracks,\n    cameraPublication,\n    microphonePublication,\n    screenSharePublication,\n    metadata,\n  };\n}\n"],"mappings":"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","ignoreList":[]}